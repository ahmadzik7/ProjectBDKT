<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Input Gramasi 125 Pcs - Quality Control</title>
  <style>
    :root {
      --bg: #121212;
      --card: #1e1e1e;
      --text: #ffffff;
      --primary: #2858dd;
      --accent: #bbdefb;
      --border: #333;
      --hover: #2a2a2a;
      --success: #1a521f;
      --warning: #523a0a;
      --error: #521a1a;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background: var(--bg);
      color: var(--text);
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    }
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 15px;
      background: linear-gradient(135deg, var(--primary), #5e391b);
      border-radius: 8px;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .form-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
    }
    @media (max-width: 768px) {
      .form-section {
        grid-template-columns: 1fr;
      }
    }
    .input-area {
      background: #1a1a1a;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .summary-area {
      background: #1a1a1a;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--accent);
    }
    input, select {
      width: 100%;
      padding: 14px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 16px;
      transition: all 0.2s ease;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(187, 222, 251, 0.2);
    }
    input[readonly] {
      background: #2a2a2a;
      cursor: not-allowed;
    }
    button {
      width: 100%;
      padding: 14px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.2s;
    }
    button:hover:not(:disabled) {
      background: #1b5e20;
    }
    button:disabled {
      background: #555;
      cursor: not-allowed;
    }
    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    .btn-secondary {
      background: #424242;
    }
    .btn-secondary:hover {
      background: #555;
    }
    .btn-success {
      background: #1a521a;
    }
    .btn-success:hover {
      background: #2a7a2a;
    }
    .btn-warning {
      background: #523a0a;
    }
    .btn-warning:hover {
      background: #7a540d;
    }
    .message {
      padding: 12px;
      margin: 15px 0;
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
      display: none;
    }
    .success { 
      background: var(--success); 
      color: #bbdefb; 
      display: block;
    }
    .error { 
      background: var(--error); 
      color: #ffcccb; 
      display: block;
    }
    .warning {
      background: var(--warning);
      color: #fff8e1;
      display: block;
    }
    .grid-container {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-top: 15px;
    }
    .weight-input-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .weight-input-label {
      font-size: 11px;
      color: var(--accent);
      margin-bottom: 2px;
      width: 100%;
      text-align: center;
    }
    .weight-input {
      width: 100%;
      padding: 8px;
      text-align: center;
      font-size: 14px;
      background: #1a1a1a;
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
    }
    .std-values {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    .std-card {
      background: #252525;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    .std-card h4 {
      font-size: 14px;
      color: var(--accent);
      margin-bottom: 5px;
    }
    .std-card .value {
      font-size: 18px;
      font-weight: bold;
    }
    .summary-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    .summary-table th, .summary-table td {
      padding: 10px;
      text-align: center;
      border: 1px solid var(--border);
    }
    .summary-table th {
      background: var(--primary);
      font-weight: bold;
    }
    .summary-table tr:nth-child(even) {
      background: #1a1a1a;
    }
    .summary-table .category-over { background: #521a1a; }
    .summary-table .category-over-std { background: #523a0a; }
    .summary-table .category-std-tu1 { background: #1a521a; }
    .summary-table .category-tu1-tu2 { background: #0a5252; }
    .summary-table .total-row { font-weight: bold; }
    .hidden {
      display: none;
    }
    .info-box {
      background: #252525;
      border-left: 4px solid var(--accent);
      padding: 15px;
      border-radius: 0 8px 8px 0;
      margin-top: 20px;
      font-size: 14px;
    }
    .info-box h3 {
      color: var(--accent);
      margin-bottom: 8px;
    }
    .data-info {
      background: #252525;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      text-align: center;
    }
    .data-info h3 {
      color: var(--accent);
      margin-bottom: 10px;
    }
    .data-info p {
      margin: 5px 0;
      font-size: 14px;
    }
    .data-info .highlight {
      font-weight: bold;
      color: var(--primary);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Input Gramasi BDKT</h1>
    </header>

    <div class="form-section">
      <div class="input-area">
        <div class="form-group">
          <label for="tanggal">Tanggal Produksi:</label>
          <input type="date" id="tanggal" required />
        </div>

        <div class="form-group">
          <label for="mesin">Mesin:</label>
          <select id="mesin" required>
            <option value="">-- Pilih Mesin --</option>
            <option value="D1">D1</option>
            <option value="D2">D2</option>
            <option value="D3">D3</option>
            <option value="D4">D4</option>
            <option value="D5">D5</option>
            <option value="D6">D6</option>
            <option value="D7">D7</option>
            <option value="D8">D8</option>
            <option value="D9">D9</option>
            <option value="D10">D10</option>
            <option value="D11">D11</option>
            <option value="D12">D12</option>
            <option value="D13">D13</option>
            <option value="D14">D14</option>
            <option value="D16">D16</option>
            <option value="D17">D17</option>

          </select>
        </div>

        <div class="form-group">
          <label for="filler">Filler:</label>
          <select id="filler" required>
            <option value="">-- Pilih Filler --</option>
            <option value="Filler 1">Filler 1</option>
            <option value="Filler 2">Filler 2</option>
          </select>
        </div>

        <div class="data-info">
          <h3>üìä Informasi Data</h3>
          <p><span class="highlight">Mesin:</span> <span id="info-mesin">-</span></p>
          <p><span class="highlight">Filler:</span> <span id="info-filler">-</span></p>
          <p><span class="highlight">Data Terisi:</span> <span id="info-filled">0/125</span></p>
        </div>

        <div class="form-group">
          <label>Input 125 Pcs Gramasi (gr):</label>
          <div class="grid-container" id="weights-grid">
            <!-- 125 input fields akan di-generate di sini -->
          </div>
        </div>

        <div class="std-values">
          <div class="std-card">
            <h4>STD</h4>
            <div class="value" id="std-value">79.20</div>
          </div>
          <div class="std-card">
            <h4>MIN STD</h4>
            <div class="value" id="min-std-value">78.70</div>
          </div>
          <div class="std-card">
            <h4>MAX STD</h4>
            <div class="value" id="max-std-value">82.70</div>
          </div>
          <div class="std-card">
            <h4>TU1</h4>
            <div class="value" id="tu1-value">74.70</div>
          </div>
          <div class="std-card">
            <h4>TU2</h4>
            <div class="value" id="tu2-value">70.20</div>
          </div>
        </div>

        <div class="btn-group">
          <button type="button" id="calculateBtn">üìä Hitung Summary</button>
          <button type="button" id="exportXlsxBtn" class="btn-secondary">üì• Ekspor XLSX</button>
        </div>

        <div class="btn-group">
          <button type="button" id="submitBtn" class="btn-success">üì§ Kirim ke Spreadsheet</button>
          <button type="button" id="resetBtn" class="btn-warning">üîÑ Reset Form</button>
        </div>

        <div id="message" class="message"></div>

        <div class="info-box">
          <h3>Panduan Pengisian</h3>
          <p>1. Pilih Mesin dan Filler yang akan diinput data</p>
          <p>2. Isi semua 125 pcs berat produk sesuai hasil timbangan</p>
          <p>3. Klik "Hitung Summary" untuk melihat analisis data</p>
          <p>4. Pastikan semua data valid sebelum mengirim ke spreadsheet</p>
          <p>5. Gunakan tombol "Ekspor XLSX" untuk menyimpan data dalam format Excel</p>
        </div>
      </div>

      <div class="summary-area">
        <h2>üìä Ringkasan Analisis</h2>
        <div class="form-group">
          <label>Basic Data:</label>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Filler 1</th>
                <th>Filler 2</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Average</td>
                <td id="avg-filler1">-</td>
                <td id="avg-filler2">-</td>
              </tr>
              <tr>
                <td>Min (g)</td>
                <td id="min-filler1">-</td>
                <td id="min-filler2">-</td>
              </tr>
              <tr>
                <td>Max (g)</td>
                <td id="max-filler1">-</td>
                <td id="max-filler2">-</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="form-group">
          <label>ANALISA DATA:</label>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Kategori</th>
                <th>Filler 1</th>
                <th>Filler 2</th>
                <th>%Filler 1</th>
                <th>%Filler 2</th>
              </tr>
            </thead>
            <tbody>
              <tr class="category-over">
                <td>Over (>82.7gr)</td>
                <td id="over-filler1">0</td>
                <td id="over-filler2">0</td>
                <td id="over-pct1">0.00%</td>
                <td id="over-pct2">0.00%</td>
              </tr>
              <tr class="category-over-std">
                <td>Over - STD (82.7 - 79.2gr)</td>
                <td id="over-std-filler1">0</td>
                <td id="over-std-filler2">0</td>
                <td id="over-std-pct1">0.00%</td>
                <td id="over-std-pct2">0.00%</td>
              </tr>
              <tr class="category-std-tu1">
                <td>STD - TU1 (79.2 - 74.7gr)</td>
                <td id="std-tu1-filler1">0</td>
                <td id="std-tu1-filler2">0</td>
                <td id="std-tu1-pct1">0.00%</td>
                <td id="std-tu1-pct2">0.00%</td>
              </tr>
              <tr class="category-tu1-tu2">
                <td>TU1 - TU2 (74.7 - 70.2gr)</td>
                <td id="tu1-tu2-filler1">0</td>
                <td id="tu1-tu2-filler2">0</td>
                <td id="tu1-tu2-pct1">0.00%</td>
                <td id="tu1-tu2-pct2">0.00%</td>
              </tr>
              <tr class="total-row">
                <td>TOTAL (harus 125 pcs)</td>
                <td id="total-filler1">0</td>
                <td id="total-filler2">0</td>
                <td colspan="2">100.00%</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="info-box">
          <h3>Persyaratan Mutu</h3>
          <p>PERATURAN 1: Minimal harus mencapai STD</p>
          <p>PERATURAN 2: Maks 7 dalam 125</p>
        </div>
      </div>
    </div>
  </div>

  <!-- XLSX Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script>
    // Konfigurasi STD
    const STD_CONFIG = {
      std: 79.20,
      minStd: 78.70,
      maxStd: 82.70,
      tu1: 74.70,
      tu2: 70.20
    };

    // Penyimpanan data untuk kedua filler
    const fillerData = {
      'Filler 1': [],
      'Filler 2': []
    };

    // Inisialisasi form
    document.addEventListener('DOMContentLoaded', () => {
      // Generate 125 input fields dengan nomor
      generateWeightInputs();
      
      // Set today's date as default
      const today = new Date();
      const dateString = today.toISOString().split('T')[0];
      document.getElementById('tanggal').value = dateString;
      
      // Event listeners
      document.getElementById('mesin').addEventListener('change', updateInfo);
      document.getElementById('filler').addEventListener('change', updateInfo);
      document.getElementById('calculateBtn').addEventListener('click', calculateSummary);
      document.getElementById('exportXlsxBtn').addEventListener('click', exportToXLSX);
      document.getElementById('submitBtn').addEventListener('click', submitToSheets);
      document.getElementById('resetBtn').addEventListener('click', resetForm);
      
      // Initial update
      updateInfo();
    });

    function generateWeightInputs() {
      const grid = document.getElementById('weights-grid');
      grid.innerHTML = '';
      
      for (let i = 1; i <= 125; i++) {
        const wrapper = document.createElement('div');
        wrapper.className = 'weight-input-wrapper';
        
        const label = document.createElement('span');
        label.className = 'weight-input-label';
        label.textContent = i;
        
        const input = document.createElement('input');
        input.type = 'number';
        input.className = 'weight-input';
        input.step = '0.01';
        input.placeholder = 'gr';
        input.min = '0';
        input.dataset.index = i;
        input.addEventListener('input', (e) => {
          validateInput(e.target);
          updateInfo();
        });
        
        wrapper.appendChild(label);
        wrapper.appendChild(input);
        grid.appendChild(wrapper);
      }
    }

    function validateInput(input) {
      if (input.value && !isNaN(input.value)) {
        input.style.backgroundColor = '#2a2a2a';
      } else {
        input.style.backgroundColor = '#1a1a1a';
      }
    }

    function updateInfo() {
      const mesin = document.getElementById('mesin').value;
      const filler = document.getElementById('filler').value;
      
      document.getElementById('info-mesin').textContent = mesin || '-';
      document.getElementById('info-filler').textContent = filler || '-';
      
      // Update filled count
      const filled = Array.from(document.querySelectorAll('.weight-input'))
        .filter(input => input.value && !isNaN(input.value)).length;
      document.getElementById('info-filled').textContent = `${filled}/125`;
    }

    function calculateSummary() {
      const mesin = document.getElementById('mesin').value;
      const filler = document.getElementById('filler').value;
      
      if (!mesin || !filler) {
        showMessage('‚ö†Ô∏è Pilih Mesin dan Filler terlebih dahulu', 'warning');
        return;
      }
      
      const weights = Array.from(document.querySelectorAll('.weight-input'))
        .map(input => parseFloat(input.value) || null)
        .filter(value => value !== null);
      
      if (weights.length === 0) {
        showMessage('‚ö†Ô∏è Masukkan minimal 1 berat untuk perhitungan', 'warning');
        return;
      }
      
      if (weights.length < 125) {
        showMessage(`‚ö†Ô∏è Data tidak lengkap: ${weights.length}/125 pcs`, 'warning');
      } else {
        showMessage('‚úÖ Data lengkap (125 pcs)', 'success');
      }
      
      // Simpan data ke filler yang dipilih
      fillerData[filler] = [...weights];
      
      // Basic calculations
      const average = weights.reduce((sum, val) => sum + val, 0) / weights.length;
      const min = Math.min(...weights);
      const max = Math.max(...weights);
      
      // Categorize weights
      const categories = {
        over: 0,
        overStd: 0,
        stdTu1: 0,
        tu1Tu2: 0
      };
      
      weights.forEach(weight => {
        if (weight > STD_CONFIG.maxStd) {
          categories.over++;
        } else if (weight > STD_CONFIG.std) {
          categories.overStd++;
        } else if (weight > STD_CONFIG.tu1) {
          categories.stdTu1++;
        } else if (weight > STD_CONFIG.tu2) {
          categories.tu1Tu2++;
        }
      });
      
      // Update UI berdasarkan filler yang dipilih
      const fillerNum = filler === 'Filler 1' ? '1' : '2';
      
      document.getElementById(`avg-filler${fillerNum}`).textContent = average.toFixed(2);
      document.getElementById(`min-filler${fillerNum}`).textContent = min.toFixed(2);
      document.getElementById(`max-filler${fillerNum}`).textContent = max.toFixed(2);
      
      // Update categories
      document.getElementById(`over-filler${fillerNum}`).textContent = categories.over;
      document.getElementById(`over-std-filler${fillerNum}`).textContent = categories.overStd;
      document.getElementById(`std-tu1-filler${fillerNum}`).textContent = categories.stdTu1;
      document.getElementById(`tu1-tu2-filler${fillerNum}`).textContent = categories.tu1Tu2;
      document.getElementById(`total-filler${fillerNum}`).textContent = weights.length;
      
      // Calculate percentages
      const total = weights.length;
      if (total > 0) {
        document.getElementById(`over-pct${fillerNum}`).textContent = ((categories.over / total) * 100).toFixed(2) + '%';
        document.getElementById(`over-std-pct${fillerNum}`).textContent = ((categories.overStd / total) * 100).toFixed(2) + '%';
        document.getElementById(`std-tu1-pct${fillerNum}`).textContent = ((categories.stdTu1 / total) * 100).toFixed(2) + '%';
        document.getElementById(`tu1-tu2-pct${fillerNum}`).textContent = ((categories.tu1Tu2 / total) * 100).toFixed(2) + '%';
      }
      
      // Update STD values in UI
      document.getElementById('std-value').textContent = STD_CONFIG.std.toFixed(2);
      document.getElementById('min-std-value').textContent = STD_CONFIG.minStd.toFixed(2);
      document.getElementById('max-std-value').textContent = STD_CONFIG.maxStd.toFixed(2);
      document.getElementById('tu1-value').textContent = STD_CONFIG.tu1.toFixed(2);
      document.getElementById('tu2-value').textContent = STD_CONFIG.tu2.toFixed(2);
    }

    function exportToXLSX() {
      const mesin = document.getElementById('mesin').value;
      const filler = document.getElementById('filler').value;
      
      if (!mesin || !filler) {
        showMessage('‚ö†Ô∏è Pilih Mesin dan Filler terlebih dahulu', 'warning');
        return;
      }
      
      const weights = Array.from(document.querySelectorAll('.weight-input'))
        .map(input => parseFloat(input.value) || '')
        .filter(value => value !== '');
      
      if (weights.length === 0) {
        showMessage('‚ö†Ô∏è Tidak ada data untuk diekspor', 'warning');
        return;
      }
      
      // Create worksheet
      const wsData = [
        ['No', 'Gramasi (gr)'],
        ...weights.map((value, index) => [index + 1, value])
      ];
      
      const ws = XLSX.utils.aoa_to_sheet(wsData);
      
      // Add summary section
      const fillerNum = filler === 'Filler 1' ? '1' : '2';
      const summaryData = [
        ['Laporan Gramasi 125 Pcs'],
        ['Mesin', mesin],
        ['Filler', filler],
        ['Tanggal', document.getElementById('tanggal').value],
        [],
        ['Summary'],
        ['Parameter', 'Value'],
        ['Average', document.getElementById(`avg-filler${fillerNum}`).textContent],
        ['Min', document.getElementById(`min-filler${fillerNum}`).textContent],
        ['Max', document.getElementById(`max-filler${fillerNum}`).textContent],
        ['Over (>82.7gr)', document.getElementById(`over-filler${fillerNum}`).textContent],
        ['Over-STD (82.7-79.2gr)', document.getElementById(`over-std-filler${fillerNum}`).textContent],
        ['STD-TU1 (79.2-74.7gr)', document.getElementById(`std-tu1-filler${fillerNum}`).textContent],
        ['TU1-TU2 (74.7-70.2gr)', document.getElementById(`tu1-tu2-filler${fillerNum}`).textContent],
        ['Total', document.getElementById(`total-filler${fillerNum}`).textContent]
      ];
      
      const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
      
      // Create workbook
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Data Gramasi");
      XLSX.utils.book_append_sheet(wb, summaryWs, "Ringkasan");
      
      // Export
      XLSX.writeFile(wb, `Laporan_Gramasi_${mesin}_${filler}_${new Date().toISOString().slice(0,10)}.xlsx`);
      showMessage('‚úÖ Data berhasil diekspor ke XLSX', 'success');
    }

    function submitToSheets() {
      const mesin = document.getElementById('mesin').value;
      const filler = document.getElementById('filler').value;
      
      if (!mesin || !filler) {
        showMessage('‚ö†Ô∏è Pilih Mesin dan Filler terlebih dahulu', 'warning');
        return;
      }
      
      const btn = document.getElementById('submitBtn');
      const original = btn.textContent;
      btn.textContent = 'Mengirim...';
      btn.disabled = true;
      
      const weights = Array.from(document.querySelectorAll('.weight-input'))
        .map(input => input.value);
      
      const formData = new FormData();
      formData.append('tanggal', document.getElementById('tanggal').value);
      formData.append('mesin', mesin);
      formData.append('filler', filler);
      formData.append('total', weights.length);
      
      // Add all 125 weights
      weights.forEach((weight, index) => {
        formData.append(`weight${index + 1}`, weight);
      });
      
      // Add summary data
      const fillerNum = filler === 'Filler 1' ? '1' : '2';
      formData.append('average', document.getElementById(`avg-filler${fillerNum}`).textContent);
      formData.append('min', document.getElementById(`min-filler${fillerNum}`).textContent);
      formData.append('max', document.getElementById(`max-filler${fillerNum}`).textContent);
      formData.append('over', document.getElementById(`over-filler${fillerNum}`).textContent);
      formData.append('overStd', document.getElementById(`over-std-filler${fillerNum}`).textContent);
      formData.append('stdTu1', document.getElementById(`std-tu1-filler${fillerNum}`).textContent);
      formData.append('tu1Tu2', document.getElementById(`tu1-tu2-filler${fillerNum}`).textContent);
      
      // Simulated Google Apps Script URL
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw0b6Xcb0ub3hzdaxHnG2vDLo7npC4F9VqD-Y4ZbNo0Tj4m1yM2fLvaTaEAtd3Ak7_K4g/exec';
      
      fetch(SCRIPT_URL, { method: 'POST', body: formData })
        .then(r => r.json())
        .then(d => {
          showMessage('‚úÖ Data berhasil dikirim ke spreadsheet!', 'success');
          
          // Clear form setelah berhasil kirim
          setTimeout(() => {
            clearCurrentFiller();
          }, 2000);
        })
        .catch(e => {
          console.error(e);
          showMessage('‚ùå Gagal mengirim data ke spreadsheet.', 'error');
        })
        .finally(() => {
          btn.textContent = original;
          btn.disabled = false;
        });
    }

    function clearCurrentFiller() {
      // Clear all weight inputs
      document.querySelectorAll('.weight-input').forEach(input => {
        input.value = '';
        input.style.backgroundColor = '#1a1a1a';
      });
      
      // Reset info
      updateInfo();
      
      // Clear message
      document.getElementById('message').className = 'message';
      document.getElementById('message').textContent = '';
    }

    function resetForm() {
      // Reset all inputs
      document.getElementById('tanggal').value = '';
      document.getElementById('mesin').value = '';
      document.getElementById('filler').value = '';
      
      // Clear all weight inputs
      document.querySelectorAll('.weight-input').forEach(input => {
        input.value = '';
        input.style.backgroundColor = '#1a1a1a';
      });
      
      // Reset summary
      document.querySelectorAll('.summary-table td').forEach(td => {
        if (td.id.includes('filler')) {
          td.textContent = '-';
        }
      });
      
      // Reset totals
      document.getElementById('over-filler1').textContent = '0';
      document.getElementById('over-filler2').textContent = '0';
      document.getElementById('over-std-filler1').textContent = '0';
      document.getElementById('over-std-filler2').textContent = '0';
      document.getElementById('std-tu1-filler1').textContent = '0';
      document.getElementById('std-tu1-filler2').textContent = '0';
      document.getElementById('tu1-tu2-filler1').textContent = '0';
      document.getElementById('tu1-tu2-filler2').textContent = '0';
      document.getElementById('total-filler1').textContent = '0';
      document.getElementById('total-filler2').textContent = '0';
      document.getElementById('over-pct1').textContent = '0.00%';
      document.getElementById('over-pct2').textContent = '0.00%';
      document.getElementById('over-std-pct1').textContent = '0.00%';
      document.getElementById('over-std-pct2').textContent = '0.00%';
      document.getElementById('std-tu1-pct1').textContent = '0.00%';
      document.getElementById('std-tu1-pct2').textContent = '0.00%';
      document.getElementById('tu1-tu2-pct1').textContent = '0.00%';
      document.getElementById('tu1-tu2-pct2').textContent = '0.00%';
      
      // Clear stored data
      fillerData['Filler 1'] = [];
      fillerData['Filler 2'] = [];
      
      // Clear message
      document.getElementById('message').className = 'message';
      document.getElementById('message').textContent = '';
      
      // Update info
      updateInfo();
    }

    function showMessage(text, type) {
      const message = document.getElementById('message');
      message.textContent = text;
      message.className = 'message ' + type;
      
      // Auto hide after 5 seconds
      setTimeout(() => {
        if (message.textContent === text) {
          message.className = 'message';
        }
      }, 5000);
    }
  </script>
</body>
</html>